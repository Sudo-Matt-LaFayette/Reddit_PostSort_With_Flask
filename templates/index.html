{% extends "base.html" %}

{% block title %}{{ location_name }} Weather{% endblock %}

{% block content %}
<div class="dashboard">
    <section class="map-panel" aria-label="Weather map">
        <div class="map-controls" aria-hidden="true">
            <button class="map-control-button" type="button" aria-label="Zoom in">+</button>
            <button class="map-control-button" type="button" aria-label="Zoom out">-</button>
            <button class="map-control-button" type="button" aria-label="Center map">
                <i class="fa-solid fa-location-crosshairs"></i>
            </button>
        </div>
        {% if map_url %}
            <img src="{{ map_url }}" alt="Weather map for {{ location_name }}" class="map-image">
        {% else %}
            <div class="map-placeholder">
                <div>
                    <h3>Map preview unavailable</h3>
                    <p>Add MAPBOX_ACCESS_TOKEN to enable live tiles.</p>
                </div>
            </div>
        {% endif %}
        <div class="map-footer">
            {{ location_name }}
        </div>
    </section>

    <section class="info-panel">
        <div class="header-row">
            <div class="date-time">
                <div class="date">{{ current_date }}</div>
                <div class="time">{{ current_time }}</div>
                <div class="sun-times">
                    <span><i class="fa-solid fa-sun"></i> {{ sunrise_today }}</span>
                    <span><i class="fa-solid fa-moon"></i> {{ sunset_today }}</span>
                </div>
            </div>

            <form class="location-form" method="get">
                <div>
                    <label for="location">Location</label>
                    <input
                        type="text"
                        id="location"
                        name="location"
                        value="{{ location_query }}"
                        placeholder="City, state or ZIP"
                        autocomplete="off"
                    >
                </div>
                <div>
                    <label for="units">Units</label>
                    <select id="units" name="units">
                        <option value="imperial" {% if units == 'imperial' %}selected{% endif %}>Imperial (F)</option>
                        <option value="metric" {% if units == 'metric' %}selected{% endif %}>Metric (C)</option>
                    </select>
                </div>
                <button type="submit">Update</button>
            </form>
        </div>

        {% if status_message %}
            <div class="status-banner">{{ status_message }}</div>
        {% endif %}

        <div class="current-block">
            <div class="current-location">
                <i class="fa-solid fa-location-dot"></i>
                {{ location_name }}
            </div>
            <div class="current-main">
                <div>
                    <div class="current-temp">{{ current.temperature }} {{ units_label.temp }}</div>
                    <div class="current-meta">Feels like {{ current.feels_like }} {{ units_label.temp }}</div>
                </div>
                <div class="current-condition">
                    <i class="fa-solid {{ current.icon }}"></i>
                    <span>{{ current.condition }}</span>
                </div>
            </div>
            <div class="stats-grid">
                {% for stat in current.stats %}
                <div class="stat-item">
                    <i class="fa-solid {{ stat.icon }}"></i>
                    <div>
                        <div class="stat-label">{{ stat.label }}</div>
                        <div class="stat-value">{{ stat.value }}</div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <div class="daily-section">
            <div class="section-title">Daily outlook</div>
            <div class="daily-grid">
                {% for day in daily %}
                <div class="day-card">
                    <div class="day-name">{{ day.day_name }}</div>
                    <div class="day-date">{{ day.date }}</div>
                    <div class="day-condition">
                        <i class="fa-solid {{ day.icon }}"></i>
                        <span>{{ day.condition }}</span>
                    </div>
                    <div class="day-temps">
                        <span>High {{ day.high }} {{ units_label.temp }}</span>
                        <span>Low {{ day.low }} {{ units_label.temp }}</span>
                    </div>
                    <div class="day-sun">
                        <span><i class="fa-solid fa-sun"></i> {{ day.sunrise }}</span>
                        <span><i class="fa-solid fa-moon"></i> {{ day.sunset }}</span>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>
</div>
{% endblock %}
